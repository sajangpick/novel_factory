# 📚 참조자료 색인 (Reference Index)

> ⚠️ **이 파일은 모든 AI 세션이 작업 시작 전에 반드시 읽어야 하는 "안내 지도"다.**
> 무림 M&A 소설 제작 시스템에는 약 38개, 19,000줄의 참조 자료가 있다.
> 전부 읽을 필요 없다. **지금 하려는 작업에 맞는 파일만** 로딩하면 된다.

---

## 🔴 작업별 필수 참조 파일 (Quick Guide)

### 📝 "소설 집필" (제N화 작성)

**반드시 읽을 파일 (4개)**:
| 순서 | 파일 | 경로 | 이유 |
|------|------|------|------|
| 1 | **소설 진행 마스터** | `novels/murim_mna/소설_진행_마스터.md` | ⭐ 유일한 추적 파일. §1~§7에 현재 상태, 떡밥, 관계, 감정, 팩트, 기억카드 전부 포함 |
| 2 | **집필 규칙** | `novels/murim_mna/집필_규칙.md` | 무림 M&A 전용 규칙 (3인격, 말투, 코미디 등) |
| 3 | **마스터 스토리 바이블** | `novels/murim_mna/master_story_bible.md` | 전체 줄거리, 해당 화 설계 확인 |
| 4 | **캐릭터 인명록** | `novels/murim_mna/캐릭터_인명록.md` | 등장 인물 카드, 3인격 시스템, 말투 |

**장면에 따라 추가 로딩**:
| 장면 유형 | 추가 파일 |
|----------|----------|
| 전투 장면 | `system/무공_기법_대전.md` (무공 DB + 6대 스승 전투 철학) |
| 이동 장면 | `novels/murim_mna/world_db/이동_동선_DB.md` + `지리_상세.md` |
| 식사/요리 장면 | `novels/murim_mna/world_db/음식_건축_DB.md` |
| 객잔/숙소 장면 | `novels/murim_mna/world_db/지역별_객잔_DB.md` + `음식_건축_DB.md` |
| 경영/사업 장면 | `novels/murim_mna/world_db/경제_시스템_심화.md` + `이준혁_현대지식_DB.md` |
| 의복 묘사 | `novels/murim_mna/world_db/의복_복식_DB.md` |
| 무기 등장 | `novels/murim_mna/world_db/무기_병기_DB.md` |
| 세력 관계 | `novels/murim_mna/world_db/세력도.md` + `조직도_완전판.md` |

**집필 후 업데이트할 파일 (2개)**:
| 파일 | 업데이트 내용 |
|------|-------------|
| `소설_진행_마스터.md` | §1~§7 각 섹션 갱신 (현재 상태, 다음 화 주의, 떡밥, 관계, 감정, 팩트, 기억카드) |
| `캐릭터_인명록.md` | 이준혁 학습 이력 등 추가 |

---

### ⚔️ "전투 장면 집필"

| 순서 | 파일 | 내용 |
|------|------|------|
| 1 | `system/무공_기법_대전.md` | 무공 기법 DB (12편) + 용대운 스타일 + 6대 스승 철학 + 체크리스트 |
| 2 | `novels/murim_mna/world_db/전투_안무가이드.md` | 전투 안무 설계 가이드 |
| 3 | `novels/murim_mna/world_db/무기_병기_DB.md` | 무기 상세 스펙 |
| 4 | `novels/murim_mna/캐릭터_인명록.md` | 교전 상대의 무공/성격 카드 |

---

### 🗺️ "세계관 작업" (설정 추가/수정)

| 파일 | 내용 |
|------|------|
| `novels/murim_mna/world_db/지리_상세.md` | 지역 정보, 거리, 소요 시간 |
| `novels/murim_mna/world_db/이동_동선_DB.md` | 이동 경로 데이터 |
| `novels/murim_mna/world_db/경제_시스템_심화.md` | 화폐, 물가, 경제 구조 |
| `novels/murim_mna/world_db/음식_건축_DB.md` | 음식, 건축, 생활문화 |
| `novels/murim_mna/world_db/의복_복식_DB.md` | 의복, 복식, 장신구 |
| `novels/murim_mna/world_db/무협_용어집.md` | 무협 용어 사전 |
| `novels/murim_mna/world_db/경영_용어집.md` | 경영 용어 사전 |

---

### 👤 "캐릭터 작업" (인물 추가/수정)

| 파일 | 내용 |
|------|------|
| `novels/murim_mna/캐릭터_인명록.md` | 핵심 30인 + 단역 시스템 + 3인격 엔진 |
| `novels/murim_mna/world_db/이준혁_현대지식_DB.md` | 이준혁 지식 체계 + 욕구불만 시스템 |
| `novels/murim_mna/소설_진행_마스터.md` §4 | 인물 간 관계 매트릭스 |

---

### 📊 "품질 검수" (집필 후 검증)

| 파일 | 내용 |
|------|------|
| `.cursorrules` | 집필 규칙 전체 (소설체 강제, 3인격 엔진, 코미디 쿼터 등) |
| `소설_진행_마스터.md` §6 | 확정 팩트 검증 데이터 |
| `소설_진행_마스터.md` §7 | 최근 5화 기억카드 (연속성 확인) |

---

### 🏭 "시스템 작업" (프로그램 개발/구조 변경)

| 파일 | 내용 |
|------|------|
| `README.md` | 개발 로그, 아키텍처 기록 |
| `system/문체_가이드.md` | 문체 규칙 (공장 레벨) |
| `system/테마_주제의식.md` | 테마/주제 (공장 레벨) |
| `system/경쟁작_차별화.md` | 경쟁작 분석 |
| `system/독자_타겟분석.md` | 독자 타겟 |
| `system/templates/` | 설계 템플릿 |

---

### 🖥️ 시스템 아키텍처 — "이미 뭐가 만들어져 있나?"

> ⚠️ **AI는 코드 작업 전에 반드시 이 섹션을 읽어라.**
> 이미 구축된 기능을 또 만들자고 제안하면 안 된다.
> 새 기능을 제안하기 전에 아래 목록에서 이미 있는지 먼저 확인하라.

#### 📍 핵심 파이프라인 — 소설 생성 (이미 구축 완료)

```
[1단계] 전략 브리핑 → [2단계] 자동 설계도 → [3단계] 구조 설계(AI) → [4단계] 본문 생성(AI+RAG)
```

| 단계 | API 경로 | 역할 | AI 사용 | 비용 |
|------|---------|------|---------|------|
| **1단계** | `/api/strategic-briefing` | bible+master 읽어서 방향 A/B 선택지 + 클리프행어 생성 | ✅ | ~$0.02 |
| **2단계** | `/api/auto-blueprint` | bible+master+이전화 엔딩 → 설계도 자동 조합 | ❌ (파일 읽기만) | $0 |
| **3단계** | `/api/structure-design` | 설계도 → 6하원칙 + 5막 상세 구조 확장 (Claude/Gemini) | ✅ | ~$0.05 |
| **4단계** | `/api/generate-episode` | 설계도+구조+RAG → 소설 본문 생성 (Gemini/Claude) | ✅ | ~$0.30 |

#### 📍 RAG 시스템 (generate-episode 내장, 별도 구축 불필요)

| 기능 | 동작 | 코드 위치 |
|------|------|----------|
| **캐릭터 카드 자동 추출** | blueprint에 이름 있으면 → 인명록에서 해당 카드 추출 (최대 8명) | `extractLoreReferences()` |
| **세계관 설정 자동 추출** | 안씨표국/천화련 등 키워드 → 바이블에서 해당 섹션 추출 | `extractBibleSection()` |
| **해당 화수 설계 강제 주입** | 14화 생성 시 → 바이블에서 14화 행 추출 + "반드시 따르세요" 지시 | `extractLoreReferences()` 내 |
| **이전 화 엔딩 자동 연결** | 이전 화 마지막 3000자 추출 → 프롬프트에 주입 | POST 핸들러 내 |
| **스타일 레퍼런스** | 최근 5화에서 명문장 추출 → 문체 일관성 유지 | `extractStyleReference()` |
| **캐릭터 보이스 앵커링** | 최근 3화에서 캐릭터 대사 추출 → 말투 일관성 유지 | `extractCharacterVoices()` |

#### 📍 품질 검수 API (구축 완료)

| API 경로 | 역할 |
|---------|------|
| `/api/ep-check` | EP(에러포인트) 자동 검수 — 설정 위반 탐지 |
| `/api/quality-check` | 품질 점수 채점 |

#### 📍 데이터 관리 API (구축 완료)

| API 경로 | 역할 |
|---------|------|
| `/api/save-episode` | 에피소드 파일 저장 |
| `/api/load-episode` | 에피소드 파일 로드 |
| `/api/delete-episode` | 에피소드 삭제 (폐기 백업 포함) |
| `/api/episodes` | 에피소드 목록 조회 |
| `/api/update-master` | 소설_진행_마스터 자동 업데이트 |
| `/api/memory-card` | 기억카드 관리 |
| `/api/extract-episode-data` | 에피소드에서 데이터 추출 |

#### 📍 캐릭터/세계관 관리 API (구축 완료)

| API 경로 | 역할 |
|---------|------|
| `/api/upload-characters` | 캐릭터 DB 업로드 (Supabase) |
| `/api/enrich-characters` | 캐릭터 정보 보강 |
| `/api/generate-cast` | 등장인물 캐스팅 생성 |
| `/api/generate-1000-characters` | 대량 캐릭터 생성 |
| `/api/sync-worlddb` | 세계관 DB 동기화 |
| `/api/terminology` | 용어 관리 |

#### 📍 대시보드/기타 API (구축 완료)

| API 경로 | 역할 |
|---------|------|
| `/api/novel-dashboard` | 대시보드 데이터 제공 |
| `/api/roadmap` | 로드맵 데이터 |
| `/api/strategy-files` | 전략 파일 관리 |
| `/api/read-file` | 파일 읽기 유틸리티 |
| `/api/rag-search` | RAG 검색 |
| `/api/generate-design` | 스노우볼링 5단계 설계 생성 |
| `/api/generate-outline` | 아웃라인 생성 |
| `/api/manuscript/[id]` | 원고 관리 |
| `/api/test-db` | DB 연결 테스트 |

#### 📍 데이터 흐름 요약

```
[소설 참조 파일들]                    [시스템]
master_story_bible.md ──┐
소설_진행_마스터.md ────┤──→ auto-blueprint ──→ structure-design ──→ generate-episode
캐릭터_인명록.md ──────┤                                              ↑
이전화 output/*.md ────┘                                    RAG (인명록+바이블 자동 주입)
                                                                      ↓
                                                              output/제N화.md
                                                                      ↓
                                                           ep-check (품질 검수)
                                                                      ↓
                                                           update-master (진행 업데이트)
```

---

## 📁 전체 파일 맵 (Complete File Map)

```
novel_factory/
├── .cursorrules              ← 📌 AI 최우선 규칙 (1,378줄)
├── README.md                 ← 📌 개발 로그 (4,072줄)
│
├── system/                   ← 🏭 공장 레벨 (모든 소설에 재사용)
│   ├── 참조자료_색인.md       ← 📌 이 파일! AI가 먼저 읽는 지도
│   ├── 무공_기법_대전.md      ← ⚔️ 무공 DB + 전투 철학 (1,630줄)
│   ├── 문체_가이드.md         ← ✍️ 문체 규칙 (698줄)
│   ├── 테마_주제의식.md       ← 🎯 테마/주제 (136줄)
│   ├── 경쟁작_차별화.md       ← 📊 경쟁작 분석 (200줄)
│   ├── 독자_타겟분석.md       ← 👥 독자 타겟 (219줄)
│   └── templates/
│       ├── Step3_스켈레톤_형식.md   ← 설계 템플릿 (494줄)
│       └── 6하원칙_설계_템플릿.md   ← 6하원칙 템플릿 (606줄)
│
├── novels/murim_mna/         ← 📖 무림 M&A 전용
│   ├── 집필_규칙.md           ← ⭐ 무림 M&A 전용 규칙 (904줄) — 3인격, 말투, 코미디 등
│   ├── master_story_bible.md ← 📌 스토리 바이블 (416줄)
│   ├── 캐릭터_인명록.md       ← 📌 캐릭터 전체 (3,955줄)
│   │
│   ├── 소설_진행_마스터.md   ← ⭐ 유일한 추적 파일 (§1~§8 통합)
│   │                          §1 현재 상태 / §2 다음 화 주의
│   │                          §3 활성 떡밥 / §4 관계 매트릭스
│   │                          §5 감정 목표 / §6 확정 팩트
│   │                          §7 최근 5화 기억카드 / §8 아카이브
│   │
│   ├── world_db/             ← 🌏 세계관 데이터베이스
│   │   ├── 음식_건축_DB.md        ← 음식/건축 (2,004줄)
│   │   ├── 의복_복식_DB.md        ← 의복/복식 (1,701줄)
│   │   ├── 이준혁_현대지식_DB.md  ← 이준혁 지식 (1,042줄)
│   │   ├── 이동_동선_DB.md        ← 이동 경로 (1,002줄)
│   │   ├── 무기_병기_DB.md        ← 무기/병기 (937줄)
│   │   ├── 지리_상세.md           ← 지리 정보 (845줄)
│   │   ├── 지역별_객잔_DB.md      ← 객잔 정보 (791줄)
│   │   ├── 경영_용어집.md         ← 경영 용어 (459줄)
│   │   ├── 무협_용어집.md         ← 무협 용어 (494줄)
│   │   ├── 무공_시스템.md         ← 무공 등급 체계 (402줄)
│   │   ├── 전투_안무가이드.md     ← 전투 안무 (350줄)
│   │   ├── 경제_시스템_심화.md    ← 경제 시스템 (243줄)
│   │   ├── 세력도.md              ← 세력 관계 (101줄)
│   │   ├── 조직도_완전판.md       ← 조직도 (85줄)
│   │   └── Ancient_China_Spec.md  ← 고대 중국 스펙 (20줄)
│   │
│   └── output/               ← 📄 완성된 소설 본문
│       ├── 제1화.md ~ 제13화.md   ← 1~13화 완성본 (프롤로그 완료)
│       └── (14화~ 기(起) 시작 — 재생성 예정)
│
└── (app/, backend/, supabase/ 등 프로그램 코드)
```

---

## ⚡ AI 행동 규칙

### 새 세션 시작 시
```
1. 이 색인 파일(참조자료_색인.md)을 읽는다.
2. 사용자가 요청한 작업 유형을 파악한다.
3. 해당 작업의 "필수 참조 파일"만 로딩한다.
4. 작업을 수행한다.
5. 작업 후 "업데이트할 파일"을 업데이트한다.
```

### 절대 규칙
```
❌ 참조 파일을 읽지 않고 소설을 쓰는 것 = 금지
❌ 이전 화 내용을 확인하지 않고 다음 화를 쓰는 것 = 금지
❌ 캐릭터 인명록을 보지 않고 대사를 쓰는 것 = 금지
❌ 무공_기법_대전을 보지 않고 전투 장면을 쓰는 것 = 금지
```
